<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />

    <title>Delete Item</title>

    <!-- Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="style.css" />

    <!-- AOS Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
  </head>

  <body>

    <!-- navbar -->
  <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
    <a class="navbar-brand" href="#">Food WebApp</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
            <a class="nav-link" href="enteritem.html">Add Item <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item active">
          <a class="nav-link" href="deleteitem.html">Delete Item</a>
        </li>
      </ul>
      <div id="buttons1">
      </div>
    </div>
  </nav>

    <!-- Modal -->
    <div id="modalparent"></div>

    <!-- Cuisines -->
    <section id="cuisines" class="container">
      <h1 class="text-center">Cuisines Offered</h1>
      <hr />
      <br />
      <div id="IndianRoot">
        <h2 class="text-center">Indian</h2>
        <br />
        <br />
        <div class="row" id="Indian"></div>
        <div id="dotsf1"></div>
        <div id="IndianHide" class="row more"></div>
        <button
          onclick="myFunctionFull(document.getElementById('dotsf1'), document.getElementById('IndianHide'), document.getElementById('myBtnf1'))"
          class="btn btn-primary"
          id="myBtnf1"
        >
          View Full List
        </button>
        <hr />
        <br />
      </div>
      <div id="ItalianRoot">
        <h2 class="text-center">Italian</h2>
        <br />
        <br />
        <div class="row" id="Italian"></div>
        <div id="dotsf2"></div>
        <div id="ItalianHide" class="row more"></div>
        <button
          onclick="myFunctionFull(document.getElementById('dotsf2'), document.getElementById('ItalianHide'), document.getElementById('myBtnf2'))"
          class="btn btn-primary"
          id="myBtnf2"
        >
          View Full List
        </button>
        <hr />
        <br />
      </div>
      <div id="ChineseRoot">
        <h2 class="text-center">Chinese</h2>
        <br />
        <br />
        <div class="row" id="Chinese"></div>
        <div id="dotsf3"></div>
        <div id="ChineseHide" class="row more"></div>
        <button
          onclick="myFunctionFull(document.getElementById('dotsf3'), document.getElementById('ChineseHide'), document.getElementById('myBtnf3'))"
          class="btn btn-primary"
          id="myBtnf3"
        >
          View Full List
        </button>
        <hr />
        <br />
      </div>
      <div id="ContinentalRoot">
        <h2 class="text-center">Continental</h2>
        <br />
        <br />
        <div class="row" id="Continental"></div>
        <div id="dotsf4"></div>
        <div id="ContinentalHide" class="row more"></div>
        <button
          onclick="myFunctionFull(document.getElementById('dotsf4'), document.getElementById('ContinentalHide'), document.getElementById('myBtnf4'))"
          class="btn btn-primary"
          id="myBtnf4"
        >
          View Full List
        </button>
        <hr />
        <br />
      </div>
    </section>

    <!-- Footer -->
    <footer>
      <div class="row">
        <div class="col-sm-4 footer-column">
          <h1 class="footer-h1">Food WebApp</h1>
        </div>
        <div class="col-sm-4 footer-column">
          <h2>Links</h2>
          <hr />
          <a href="#">About</a><br />
          <a href="#">Privacy Policy</a><br />
          <a href="#">Terms and Conditions</a>
        </div>
        <div class="col-sm-4 footer-column">
          <h2>Contact Us</h2>
          <hr />
          <a href="#">Phone</a><br />
          <a href="#">Email</a>
        </div>
      </div>
      <p class="text-center">
        Copyright &copy; Food WebApp 2020. Made with &hearts; by Aditya Mitra.
      </p>
    </footer>

    <!-- JS -->
    <script>
      /*function myFunction(dots, moreText, btnText) {
      if (dots.style.display === "none") {
        dots.style.display = "inline";
        btnText.innerHTML = "View More";
        moreText.style.display = "none";
      } else {
        dots.style.display = "none";
        btnText.innerHTML = "View Less";
        moreText.style.display = "inline";
      }
    }*/
      function myFunctionFull(dots, moreText, btnText) {
        if (dots.style.display === "none") {
          dots.style.display = "inline";
          btnText.innerHTML = "View Full List";
          moreText.style.display = "none";
        } else {
          dots.style.display = "none";
          btnText.innerHTML = "View Less";
          moreText.style.display = "flex";
        }
      }
    </script>

    <!-- AOS Library-->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
      AOS.init();
    </script>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
      crossorigin="anonymous"
    ></script>

    <script>

        async function deleteitem(id) {
            console.log(localStorage.getItem("id"));
            console.log(id);
              document.getElementById(id).remove();
             await fetch(`http://localhost:3000/fooditemdelete`, {method:"DELETE",
             headers: {
              'Content-Type': 'application/json'
            }, body: JSON.stringify({id: localStorage.getItem("id"), itemid: id})
               }).then((res)=> res.json())
             .then((json) =>{
                 console.log(json)
                 alert(json.message)
             })
         }

      async function logout(id) {
        console.log(id);
        localStorage.removeItem("id")
        localStorage.removeItem("name")
        location.reload()
    }

      async function clean() {
        document.getElementById("modalparent").innerHTML = ``;
      }

      async function insertmodal(name, description, id, cuisine, image, ingredients, price, review) {
        var content = `<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">${name}</h5>
        <button type="button" onclick="clean()" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <img src="images/indian.jpg" class="card-img-top" alt="..." /><br/><br/><h6 style="color: red;">${cuisine}</h6>
        ${description}<br /> <h6 style="color: blue; display: inline;">Ingredients:</h6> ${ingredients} <br /> <h6 style="color: blue; display: inline;">Price:</h6> ${price} <br /> <h6 style="color: blue; display: inline;">Customer Reviews: </h6>${review}<br />
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" onclick="clean()" data-dismiss="modal">View Less</button>
        <button type="button" class="btn btn-danger" onclick="deleteitem('${id}')">Delete</button>
      </div>
    </div>
  </div>
</div>`;
        document.getElementById("modalparent").innerHTML += content;
      }

      $(document).ready(() => {
        if(localStorage.getItem("id")!=null){
            document.getElementById("buttons1").innerHTML = `<span style="color:white;">Welcome ${localStorage.getItem("name")}!</span>   <button id="logoutbutton" onclick="logout('${localStorage.getItem("id")}', '${localStorage.getItem("name")}')" class="btn bcolour btn-light btn-outline-success my-2 my-sm-0" type="button">      Log Out</button>`;
        }
        else{
            setInterval(function () {window.location.href = "adminlogin.html";}, 2000);
        }
        var countIndian = 0;
        var countItalian = 0;
        var countChinese = 0;
        var countContinental = 0;
        fetch("http://localhost:3000/")
          .then((response) => response.json())
          .then((json) => {
            console.log(json);
            const container = document.getElementById("cuisines");
            json.fList.forEach((entry, i) => {
              console.log(entry["_id"] +"  "+ entry._id);
              console.log(i);
              var content = `
              <div id="${entry["_id"]}" class="col-sm-4 card-padding">
                <div class="card">
                    <img src="images/indian.jpg" class="card-img-top" alt="..." />
                    <div class="card-body">
                      <h5 class="card-title">${
                        entry["item"]
                      }</h5><h6 style="color: red;"> ${entry["cuisine"]}</h6>
                      <p class="card-text">
                        ${entry["description"].substring(0, 30)}...
                      </p>
              <button type="button" class="btn btn-primary" onclick="insertmodal('${
                entry["item"]
              }', '${entry["description"]}', '${entry["_id"]}', '${
                entry["cuisine"]
              }', '${entry["image"]}', '${entry["ingredients"]}', '${entry["price"]}', '${entry["review"]}')" data-toggle="modal" data-target="#exampleModal">View More</button>
                    </div>
                    <button type="button" onclick="deleteitem('${
                      entry["_id"]
                    }')" class="btn btn-danger">Delete</button>
                  </div>
            </div>
              `;
              // Construct card content
              if (entry[`cuisine`] == "Indian" && countIndian < 3) {
                document.getElementById(
                  `${entry[`cuisine`]}`
                ).innerHTML += content;
                countIndian++;
              } else if (entry[`cuisine`] == "Italian" && countItalian < 3) {
                document.getElementById(
                  `${entry[`cuisine`]}`
                ).innerHTML += content;
                countItalian++;
              } else if (
                entry[`cuisine`] == "Continental" &&
                countContinental < 3
              ) {
                document.getElementById(
                  `${entry[`cuisine`]}`
                ).innerHTML += content;
                countContinental++;
              } else if (entry[`cuisine`] == "Chinese" && countChinese < 3) {
                document.getElementById(
                  `${entry[`cuisine`]}`
                ).innerHTML += content;
                countChinese++;
              } else {
                document.getElementById(`${entry[`cuisine`]}Hide`).innerHTML += content;
              }

            });
          });
      });
    </script>

    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    -->
  </body>
</html>
